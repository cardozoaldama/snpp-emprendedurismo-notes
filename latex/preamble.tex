% Document class configuration
\documentclass[
  12pt,
  a4paper,
  parskip=half,
  headings=standardclasses,
  numbers=noenddot,
  bibliography=totoc,
  listof=totoc,
  titlepage=firstiscover,
  spanish
]{scrartcl}

% Spanish language support
\usepackage[spanish,es-tabla]{babel}
\usepackage{fontspec}
\usepackage{csquotes}

% Typography improvements
\usepackage{microtype}
\linespread{1.15}

% Widow and orphan control
\widowpenalty=9000          % Penalty for breaking before last line of paragraph
\clubpenalty=9000           % Penalty for breaking after first line of paragraph
\displaywidowpenalty=9000   % Penalty for breaking before last line before display
\brokenpenalty=4500         % Penalty for page break after hyphenated line

% Allow flexible page heights to accommodate penalties
\raggedbottom

% Layout and structure
\usepackage{scrlayer-scrpage}
\usepackage{enumitem}
\usepackage{needspace}

% Prevent orphaned section headings (heading at bottom with no text)
\RedeclareSectionCommand[
  beforeskip=3ex plus 1ex minus .2ex,
  afterskip=1.5ex plus .2ex,
  runin=false
]{section}

\RedeclareSectionCommand[
  beforeskip=2.5ex plus .5ex minus .2ex,
  afterskip=1.5ex plus .2ex,
  runin=false
]{subsection}

% Tables and figures
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{graphicx}

% Callout boxes
\usepackage{xcolor}
\usepackage{mdframed}

% Hyperlinks and references
\usepackage{hyperref}
\hypersetup{
  colorlinks=true,
  linkcolor=black,
  urlcolor=blue!60!black,
  breaklinks=true,
  pdftitle={Competencias Emprendedoras},
  pdfauthor={Prof. Lic. Enriqueta Benítez, Ing. Fernando Cardozo}
}

% Page style configuration
\pagestyle{scrheadings}
\ihead{Competencias Emprendedoras}
\ohead{\pagemark}
\cfoot{\small\itshape Versión \docversion{} -- \builddate}
\setkomafont{pageheadfoot}{\small\itshape}
